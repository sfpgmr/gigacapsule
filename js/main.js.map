{"version":3,"sources":["main.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["'use strict';\r\n\r\nvar app = require('app');\r\nvar BrowserWindow = require('browser-window');\r\nvar ipc = require('ipc');\r\nvar fs = require('fs');\r\nvar path = require('path');\r\nvar cacheRoot = path.join(app.getPath('cache'),'sfpgmr');\r\nvar cachePath = path.join(cacheRoot,'gigacapsule');\r\nvar gigaCapsule = '';\r\n\r\nrequire('crash-reporter').start();\r\n\r\nvar mainWindow = null;\r\n\r\napp.on('window-all-closed', function() {\r\n  if (process.platform != 'darwin')\r\n    app.quit();\r\n});\r\n\r\nfunction denodeify(nodeFunc){\r\n    var baseArgs = Array.prototype.slice.call(arguments, 1);\r\n    return function() {\r\n        var nodeArgs = baseArgs.concat(Array.prototype.slice.call(arguments));\r\n        return new Promise((resolve, reject) => {\r\n            nodeArgs.push((error, data) => {\r\n                if (error) {\r\n                    reject(error);\r\n                } else if (arguments.length > 2) {\r\n                    resolve(Array.prototype.slice.call(arguments, 1));\r\n                } else {\r\n                    resolve(data);\r\n                }\r\n            });\r\n            nodeFunc.apply(null, nodeArgs);\r\n        });\r\n    }\r\n}\r\n\r\napp.on('ready', function() {\r\n  // Giga Capsule ディスクをチェックする\r\n  // Windows のみ...\r\n  var exec = denodeify(require('child_process').exec);\r\n  exec('wmic logicaldisk get caption')\r\n  .then((stdout,stderr) => {\r\n    return new Promise((resolve,reject) => {\r\n        stdout.split(/\\r\\r\\n/).forEach((d)=>{\r\n          if(d.match(/\\:/)){\r\n            let drive = d.trim();\r\n            if(fs.existsSync(drive + '/YMOGIGA.EXE')){\r\n              resolve(drive);\r\n            }\r\n          }\r\n        });\r\n        reject('Giga Capsule Disk Not Found.');\r\n    });\r\n  })\r\n  .then((drive)=>{\r\n    // Giga Capsuleのドライブ判明\r\n    gigaCapsule = path.join(drive,'/');\r\n    // キャッシュディレクトリ作成\r\n    return new Promise((resolve,reject) => {\r\n      try {\r\n        fs.mkdirSync(cacheRoot);\r\n      } catch (e) {\r\n        if(e.code !== 'EEXIST'){\r\n          reject(e.description);\r\n        }\r\n      }\r\n      try {\r\n        fs.mkdirSync(cachePath);\r\n      } catch (e) {\r\n        if(e.code !== 'EEXIST'){\r\n          reject(e.description);\r\n        }\r\n      }\r\n      resolve();\r\n    });\r\n  })\r\n  .then(()=>{\r\n    // ブラウザ(Chromium)の起動, 初期画面のロード\r\n    mainWindow = new BrowserWindow({width: 800, height: 600});\r\n    mainWindow.loadUrl('file://' + __dirname + '/../index.html');\r\n    mainWindow.on('closed', function() {\r\n      mainWindow = null;\r\n    });\r\n  })\r\n  .catch((e)=>{\r\n    console.log(e);\r\n  });\r\n  //app.quit();\r\n});"],"sourceRoot":"/source/"}